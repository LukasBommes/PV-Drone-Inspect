<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuring Multiple Sectors &mdash; PV Hawk  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Finetuning the Mask R-CNN Model" href="finetune_segmentation.html" />
    <link rel="prev" title="Using Your Own Data" href="using_own_data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> PV Hawk
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_own_data.html">Using Your Own Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuring Multiple Sectors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#difference-between-sectors-and-clusters">Difference between sectors and clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="finetune_segmentation.html">Finetuning the Mask R-CNN Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_file_reference.html">Config File Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_directory.html">Output Directory Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="built_docker_image.html">Build the Docker Image</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="method.html">How PV Hawk Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Current Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PV Hawk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Configuring Multiple Sectors</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/LukasBommes/PV-Hawk/blob/master/docs/source/configure_multiple_sectors.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuring-multiple-sectors">
<h1>Configuring Multiple Sectors<a class="headerlink" href="#configuring-multiple-sectors" title="Permalink to this headline"></a></h1>
<p>For large PV plants it is helpful to split the plant into smaller sectors and process sectors individually. To do so the structure of the working directory and the config file have to be altered slightly.</p>
<p>Lets consider an extended version of the dataset used in the <a class="reference internal" href="tutorial.html"><span class="doc">Tutorial</span></a>. Download the second part of the dataset <a class="reference external" href="https://github.com/LukasBommes/PV-Hawk/releases/download/v1.0.0/example_data_single_row.zip">from here</a>. This second part is just another scan of the same section of the PV plant (with rows scanned individually rather than in pairs). However, in practice, each dataset part will correspond to different sectors of your PV plant. But for the explanation below this difference does not matter.</p>
<p>To process both datasets in a single pipeline run, first create a new working directory with the following structure</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/storage/pv-hawk-tutorial/workdir
  |-- double_rows
  |    |-- splitted
  |    |    |-- ...
  |-- single_rows
  |    |-- splitted
  |    |    |-- ...
</pre></div>
</div>
<p>As opposed to the single-sector dataset in the tutorial, the directory levels <cite>double_rows</cite> and <cite>single_rows</cite> are introduced. The <cite>double_rows</cite> directory contains the dataset from the tutorial and the <cite>single_rows</cite> directory the newly downloaded dataset.</p>
<p>Next, create a <cite>config.yml</cite> file with the text below</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>---
plant_name: Multiple sectors
groups:
- name: double_rows
  cam_params_dir: calibration/camera_8hz/parameters/ir
  clusters:
  - cluster_idx: 0
    frame_idx_start: 0
    frame_idx_end: 2541
  settings:
    prepare_opensfm:
      select_frames_mode: gps_visual
    opensfm:
      matching_gps_distance: 15
      align_method: orientation_prior
      align_orientation_prior: vertical
- name: single_rows
  cam_params_dir: calibration/camera_8hz/parameters/ir
  clusters:
  - cluster_idx: 0
    frame_idx_start: 0
    frame_idx_end: 5295
  settings:
    prepare_opensfm:
      select_frames_mode: gps_visual
    opensfm:
      matching_gps_distance: 15
      align_method: orientation_prior
      align_orientation_prior: vertical

tasks:
  #- split_sequences
  - interpolate_gps
  - segment_pv_modules
  - track_pv_modules
  - compute_pv_module_quadrilaterals
  - prepare_opensfm
  - opensfm_extract_metadata
  - opensfm_detect_features
  - opensfm_match_features
  - opensfm_create_tracks
  - opensfm_reconstruct
  - triangulate_pv_modules
  - refine_triangulation
  - crop_pv_modules
</pre></div>
</div>
<p>The file now contains two items under <cite>groups</cite>, each configuring one of the two datasets. Note, that each item now has an additional <cite>name</cite> attribute which corresponds to the directory names of the sectors, i.e. <cite>double_rows</cite> and <cite>single_rows</cite>.</p>
<p>Apart from that, there are no differences to the simple case described in the <a class="reference internal" href="tutorial.html"><span class="doc">Tutorial</span></a>. Simply follow the remaining steps of the tutorial to process the extended dataset.</p>
<section id="difference-between-sectors-and-clusters">
<h2>Difference between sectors and clusters<a class="headerlink" href="#difference-between-sectors-and-clusters" title="Permalink to this headline"></a></h2>
<p>You could also use clusters to split a larger dataset into smaller ones. The difference to sector-based splitting is that all clusters share the same algorithm settings, whereas each sector can have its own unique settings.</p>
<p>Furthermore, a dataset with multiple clusters will be processed in a single working directory, whereas each sector has its own subdirectory. Each subdirectory is treated like an independent working directory when viewing the data with the PV Hawk Viewer.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="using_own_data.html" class="btn btn-neutral float-left" title="Using Your Own Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="finetune_segmentation.html" class="btn btn-neutral float-right" title="Finetuning the Mask R-CNN Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Lukas Bommes.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>